<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Notes</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>üìö Notes</h1>
</header>

<div class="container">

  <input
    id="search"
    placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞–º..."
    autocomplete="off"
  >

  <div id="notes"></div>

</div>

<script>
let allNotes = [];

fetch('notes.json')
  .then(r => {
    if (!r.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å notes.json');
    return r.json();
  })
  .then(data => {
    allNotes = data;
    renderNotes(data);
  })
  .catch(err => {
    document.getElementById('notes').innerHTML =
      `<p style="color:red">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤</p>`;
    console.error(err);
  });

function renderNotes(data) {
  const container = document.getElementById('notes');
  container.innerHTML = '';

  let empty = true;

  for (const section in data) {
    if (!data[section].length) continue;

    empty = false;

    const sectionEl = document.createElement('div');
    sectionEl.className = 'section';

    sectionEl.innerHTML = `<h2>${section}</h2>`;

    data[section].forEach(note => {
      const card = document.createElement('div');
      card.className = 'note';

      card.innerHTML = `
        <a href="${note.file}">
          üìÑ ${note.title}
        </a>
      `;

      sectionEl.appendChild(card);
    });

    container.appendChild(sectionEl);
  }

  if (empty) {
    container.innerHTML = '<p>–ö–æ–Ω—Å–ø–µ–∫—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
  }
}

document.getElementById('search').addEventListener('input', e => {
  const q = e.target.value.toLowerCase();
  const filtered = {};

  for (const section in allNotes) {
    filtered[section] = allNotes[section].filter(note =>
      note.title.toLowerCase().includes(q)
    );
  }

  renderNotes(filtered);
});
</script>

</body>
</html>
