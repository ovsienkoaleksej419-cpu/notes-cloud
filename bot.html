<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>AlexBot ‚Äî –ü–æ–º–æ—â–Ω–∏–∫</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- —Ç–≤–æ–π –æ—Å–Ω–æ–≤–Ω–æ–π CSS -->
  <link rel="stylesheet" href="/style.css">

  <style>
    .chat {
      max-width: 700px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      height: 80vh;
    }

    .chat-box {
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 15px;
    }

    .msg {
      padding: 14px 18px;
      border-radius: 16px;
      max-width: 80%;
      line-height: 1.5;
      font-size: 15px;
    }

    .user {
      align-self: flex-end;
      background: rgba(34,197,94,0.15);
      border: 1px solid rgba(34,197,94,0.4);
    }

    .bot {
      align-self: flex-start;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
    }

    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }

    .controls button {
      padding: 8px 14px;
      border-radius: 12px;
      border: 1px solid var(--card-border);
      background: var(--card-bg);
      color: var(--text-main);
      cursor: pointer;
    }

    .controls button.active {
      border-color: var(--accent);
      color: var(--accent);
    }

    .input-row {
      display: flex;
      gap: 10px;
    }

    input {
      flex: 1;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid var(--card-border);
      background: rgba(15,23,42,0.8);
      color: white;
    }

    .send {
      padding: 14px 22px;
      border-radius: 14px;
      background: var(--accent);
      color: black;
      font-weight: 700;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="container chat">
  <h1>ü§ñ AlexBot</h1>

  <div class="controls">
    <button id="egeBtn" class="active">–ï–ì–≠ —Ä–µ–∂–∏–º</button>
    <button id="freeBtn">–°–≤–æ–±–æ–¥–Ω—ã–π</button>
    <a href="/" class="back-link">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
  </div>

  <div id="chatBox" class="chat-box">
    <div class="msg bot">
      –ü—Ä–∏–≤–µ—Ç! –Ø AlexBot.  
      –ú–æ–≥—É —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞–Ω–∏—è –ï–ì–≠ –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ –∏–ª–∏ –æ–±—ä—è—Å–Ω—è—Ç—å —Ç–µ–º—ã.
    </div>
  </div>

  <div class="input-row">
    <input id="input" placeholder="–ù–∞–ø–∏—à–∏ –≤–æ–ø—Ä–æ—Å..." autocomplete="off">
    <button class="send" id="send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
  let mode = "ege";

  const chatBox = document.getElementById("chatBox");
  const input = document.getElementById("input");

  document.getElementById("egeBtn").onclick = () => setMode("ege");
  document.getElementById("freeBtn").onclick = () => setMode("free");

  function setMode(m) {
    mode = m;
    document.getElementById("egeBtn").classList.toggle("active", m === "ege");
    document.getElementById("freeBtn").classList.toggle("active", m === "free");
  }

  function add(text, cls) {
    const div = document.createElement("div");
    div.className = "msg " + cls;
    div.textContent = text;
    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  async function send() {
    const text = input.value.trim();
    if (!text) return;

    add(text, "user");
    input.value = "";

    try {
      const res = await fetch("/.netlify/functions/openrouter", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt: text, mode })
      });

      const data = await res.json();
      add(data.reply || "–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞", "bot");
    } catch {
      add("–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å –±–æ—Ç–æ–º", "bot");
    }
  }

  document.getElementById("send").onclick = send;
  input.addEventListener("keydown", e => e.key === "Enter" && send());
</script>

</body>
</html>
